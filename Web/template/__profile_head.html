{% extends '__head.html' %}
{% load static %}

{% block title %}{% if isFediverseUser %}ğŸŒ {% endif %}{% if targetUser.display_name %}{{ targetUser.display_name }}{% else %}{{ targetUser.username }}{% endif %} | CrossPlan{% endblock %}

{% block body %}
<h1 class="ui header">
    {% if targetUser.display_name %}{{ targetUser.display_name }}{% else %}{{ targetUser.username }}{% endif %}
    <div class="sub header">@{{ targetUser.username }}{% if isFediverseUser %}@{{ targetUser.Host }}{% endif %}</div>
</h1>
<hr>
<div class="ui stackable grid">
    <div class="four wide column">
        {% if isFediverseUser %}
        <div class="ui warning message">
            <div class="header">ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é€£åˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™ã€‚</div>
            <p>ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é€£åˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã‚ã‚Šã€æœ€æ–°ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã§ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
            <a target="_blank" href="{{ targetUser.Url }}">é€£åˆå…ˆã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’è¦‹ã‚‹</a>
        </div>
        {% endif %}
        {% if targetUser == user %}
        <a class="ui button fluid" href="{% url 'Settings_Profile' %}"><i class="pencil alternate icon"></i> ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã‚’ç·¨é›†</a>
        {% elif user.is_authenticated %}
        {% if targetUserRelation.following %}
        <button class="ui button secondary fluid" id="followBtn" onclick="sendState('follow')"><i class="user times icon"></i> ãƒ•ã‚©ãƒ­ãƒ¼è§£é™¤</button>
        {% else %}
        <button class="ui button primary fluid" id="followBtn" onclick="sendState('follow')"><i class="user plus icon"></i> ãƒ•ã‚©ãƒ­ãƒ¼</button>
        {% endif %}
        <div class="ui accordion">
            <div class="title"><i class="dropdown icon"></i> ãã®ä»–ã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ </div>
            <div class="content">
                <button class="ui button orange fluid" onclick="openUserMuteModal()"><i class="mute icon"></i> ãƒŸãƒ¥ãƒ¼ãƒˆ</button>
                <br>
                <button class="ui button negative fluid" onclick="openUserBlockModal()"><i class="ban icon"></i> ãƒ–ãƒ­ãƒƒã‚¯</button>
            </div>
        </div>
        <form method="POST" action="{% url 'UserState' %}" id="userStateForm">
            {% if isFediverseUser %}
            <input type="hidden" name="targetFedi" value="{{ targetUser.uuid }}">
            {% else %}
            <input type="hidden" name="target" value="{{ targetUser.username }}">
            {% endif %}
            <input type="hidden" name="changeState" value="" id="changeState">
            {% csrf_token %}
        </form>
        {% endif %}
        <div class="ui segment">
            <div>
                {% if targetUserRelation.followed %}<div class="ui green label">ãƒ•ã‚©ãƒ­ãƒ¼ã•ã‚Œã¦ã„ã¾ã™</div>{% endif %}
                {% if targetUser.is_bot %}<div class="ui grey label">Bot</div>{% endif %}
            </div>
            <div>
                {% if targetUser.description %}
                    {{ targetUser.description|safe }}
                {% else %}
                    <em>èª¬æ˜ãªã—</em>
                {% endif %}
            </div>
            {% if not isFediverseUser %}
            <hr>
            <p>{{ targetUser.registered }} ç™»éŒ²</p>
            {% endif %}
        </div>
        <div class="ui segment">
            <div class="ui relaxed divided list">
                <div class="item">
                    <div class="content">
                        <a class="header" href="{% if isFediverseUser %}{% else %}{% url 'UserShow' targetUser.username %}{% endif %}">æŠ•ç¨¿</a>
                        <div class="description">{{ targetUser.posts.all.count }}</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <a class="header" href="{% if isFediverseUser %}{% else %}{% url 'UserShowFollowing' targetUser.username %}{% endif %}">ãƒ•ã‚©ãƒ­ãƒ¼</a>
                        <div class="description">{{ targetUser.following.all.count }}</div>
                    </div>
                </div>
                <div class="item">
                    <div class="content">
                        <a class="header" href="{% if isFediverseUser %}{% else %}{% url 'UserShowFollower' targetUser.username %}{% endif %}">ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼</a>
                        <div class="description">{{ targetUser.followers.all.count }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="twelve wide column">
        {% block side %}{% endblock %}
    </div>
</div>

{% if user.is_authenticated and targetUser != user %}
<div class="ui basic modal" id="userMuteConfirm">
    <div class="ui icon header">
      <i class="mute icon"></i>
      ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒŸãƒ¥ãƒ¼ãƒˆ
    </div>
    <div class="content">
      <p>ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒŸãƒ¥ãƒ¼ãƒˆã—ã¾ã™ã‹ï¼Ÿ</p>
    </div>
    <div class="actions">
      <div class="ui basic cancel inverted button">
        <i class="remove icon"></i>
        ã„ã„ãˆ
      </div>
      <div class="ui orange ok inverted button">
        <i class="checkmark icon"></i>
        ã¯ã„
      </div>
    </div>
</div>

<div class="ui basic modal" id="userBlockConfirm">
    <div class="ui icon header">
      <i class="ban icon"></i>
      ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯
    </div>
    <div class="content">
      <p>ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚</p>
      <p>ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã¨ãƒ•ã‚©ãƒ­ãƒ¼ã‚„æŠ•ç¨¿ã®é–²è¦§ãŒåˆ¶é™ã•ã‚Œã¾ã™ã€‚æœ¬å½“ã«å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ</p>
    </div>
    <div class="actions">
      <div class="ui basic cancel inverted button">
        <i class="remove icon"></i>
        ã„ã„ãˆ
      </div>
      <div class="ui negative ok inverted button">
        <i class="ban icon"></i>
        ã¯ã„
      </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block script %}
{% if user.is_authenticated and targetUser != user %}
<script src="{% static 'userState.js' %}" type="text/javascript"></script>
{% endif %}
{% endblock %}
